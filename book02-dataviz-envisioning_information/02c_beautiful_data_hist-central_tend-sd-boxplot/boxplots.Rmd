---
output: html_document
editor_options: 
  chunk_output_type: console
---
# Boxplots

## Preliminaries

### Load packagtes
```{r}
library(compbio4all)
library(ggplot2)
library(cowplot)
library(ggpubr)
```

### Load data
```{r}
data(frogarms)
```


## Boxplots

Basic boxplot
```{r}
ggboxplot(data = frogarms,
          y = "mass",
          x = "sex")
```


## Aside: Notched boxplots


We'll use the original frogarms dataframe first for this
THese aren't commonly used; the notches work kind of like confidence intervals to determine if medians are different.  
```{r}
ggboxplot(data = frogarms,
          y = "mass",
          x = "sex",
          notch  = TRUE)
```


## Fill


Add colored fill; note that it is "fill" not "color".  Color changes the color of the lines
```{r}
ggboxplot(data = frogarms,
          y = "mass",
          x = "sex",
          notch  = TRUE,
          fill = "sex")
```

We can turn off the nothing by adding a "#" character before it.  This is called "**commenting out**"

```{r}
ggboxplot(data = frogarms,
          y = "mass",
          x = "sex",
          #notch  = TRUE,
          fill = "sex")
```


## Adding raw data
Add raw data to the plot.    This works best with small datasts
```{r}
ggboxplot(data = frogarms,
          y = "mass",
          x = "sex",
          #notch  = TRUE,
          fill = "sex",
          add = "point")
```


## Jitter the raw data

This can be helpful, though ggpubr::ggboxplot doesn't allow much control over the "jittering".  Jittering helpful when you have large datsets and want to avoid overlap in the points.
```{r}
ggboxplot(data = frogarms,
          y = "mass",
          x = "sex",
          #notch  = TRUE,
          fill = "sex",
          add = "jitter")
```



Label axes
```{r}
ggboxplot(data = frogarms,
          y = "mass",
          x = "sex",
          notch  = TRUE,
          fill = "sex",
          add = "jitter",
          xlab = "Sex",      #x axis (horizontal)
          ylab = "Mass (g)") #y axis (vertical)
```

Add title
not usually done for publication but useful for keeping track of things and for presentations
```{r}
ggboxplot(data = frogarms,
          y = "mass",
          x = "sex",
          notch  = TRUE,
          fill = "sex",
          add = "jitter",
          xlab = "Sex",
          ylab = "Mass (g)",
          main = "Mass of Australian frogs by sex") #Main title
```



Move legend to bottom
```{r}
ggboxplot(data = frogarms,
          y = "mass",
          x = "sex",
          notch  = TRUE,
          fill = "sex",
          add = "jitter",
          xlab = "Sex",
          ylab = "Mass (g)",
          main = "Mass of frogs by sex",
          legend = "bottom")
```


Change color pallete
```{r}
ggboxplot(data = frogarms,
          y = "mass",
          x = "sex",
          notch  = TRUE,
          fill = "sex",
          add = "jitter",
          xlab = "Sex",
          ylab = "Mass (g)",
          main = "Mass of frogs by sex",
          legend = "bottom",
          palette = c("green","blue"))
```



### Plotting multple plots with cowplot::plot_grid

```{r, eval = T, echo = T}

my.frogs <- make_my_data2L(dat = frogarms, 
                           my.code = "nlb24",  # #<=  change this!
                           cat.var = "sex",
                           n.sample = 20, 
                           with.rep = FALSE)
dim(my.frogs)
```


We can save a plot to an R object
```{r}
gg.my.frogs<- ggboxplot(data = my.frogs,
          y = "mass",
          x = "sex")


```


Call just the object (eg, just type it into the console. or highlight jsut the word)
```{r}
gg.my.frogs
```

Make an object using the frogarms data
```{r}
gg.frogarms <- ggboxplot(data = frogarms, #use original data
          y = "mass",
          x = "sex")

```


Now plot both

```{r}
plot_grid(gg.my.frogs,
          gg.frogarms)
```



Add labels.  Note that alignment is off sometimes.

```{r}
plot_grid(gg.frogarms, 
          gg.frogarms,
          labels = c("a)My fogs","b)All the frogs"))
```

