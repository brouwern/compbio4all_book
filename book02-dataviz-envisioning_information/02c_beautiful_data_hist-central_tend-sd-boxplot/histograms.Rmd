---
output: html_document
editor_options: 
  chunk_output_type: console
---
# Boxplots

## Preliminaries

### Load packagtes
```{r}
library(compbio4all)
library(ggplot2)
library(cowplot)
library(ggpubr)
```

### Load data
```{r}
data(frogarms)
```


## Boxplots

Basic histogram
```{r}
gghistogram(data = frogarms,
            x = "mass")
```

Usually a warning
Warning message:
Using `bins = 30` by default. Pick better value with the argument `bins`




## Fill


Add colored fill; note that it is "fill" not "color".  Color changes the color of the lines
```{r}
gghistogram(data = frogarms,
            x = "mass",
            fill = "red",
            xlab = "Mass (grams)")
```



## Central tendency

```{r}
gghistogram(data = frogarms,
            x = "mass",
            fill = "red",
            xlab = "Mass (grams)",
            add = "mean")
```

Warning messages:
1: Using `bins = 30` by default. Pick better value with the argument `bins`. 
2: geom_vline(): Ignoring `mapping` because `xintercept` was provided. 
3: geom_vline(): Ignoring `data` because `xintercept` was provided.


## Median
```{r}
gghistogram(data = frogarms,
            x = "mass",
            fill = "red",
            xlab = "Mass (grams)",
            add = "median")
```



Add title
not usually done for publication but useful for keeping track of things and for presentations
```{r}

gghistogram(data = frogarms,
            x = "mass",
            fill = "red",
            xlab = "Mass (grams)",
          main = "Mass of Australian frogs ") #Main title

```


## Density plot

```{r}

ggdensity(data = frogarms,
            x = "mass",
            fill = "red",
            xlab = "Mass (grams)",
          main = "Mass of Australian frogs ") #Main title

```

### Plotting multple plots with cowplot::plot_grid

make into boxplot version exercise since shown first here as hist

```{r, eval = T, echo = T}

my.frogs <- make_my_data2L(dat = frogarms, 
                           my.code = "nlb24", # #<=  change this!
                           cat.var = "sex",
                           n.sample = 20, 
                           with.rep = FALSE)
dim(my.frogs)
```


We can save a plot to an R object
```{r}
gg.hist.my.frogs <- gghistogram(data = my.frogs,
            x = "mass",
            fill = "red",
            xlab = "Mass (grams)") #Main title


gg.hist.frog <- gghistogram(data = frogarms,
            x = "mass",
            fill = "red",
            xlab = "Mass (grams)") #Main title

```



Now plot both

```{r}
plot_grid(gg.hist.my.frogs,
          gg.hist.frog)
```



Add labels.  Note that alignment is off sometimes.

```{r}
plot_grid(gg.hist.my.frogs, 
          gg.hist.frog,
          labels = c("a)My fogs","b)All the frogs"))
```


Add lines for means


We can save a plot to an R object
```{r}
gg.hist.my.frogs <- gghistogram(data = my.frogs,
            x = "mass",
            fill = "red",
            add = "mean",
            xlab = "Mass (grams)") #Main title


gg.hist.frog <- gghistogram(data = frogarms,
            x = "mass",
            fill = "red",
            add = "mean",
            xlab = "Mass (grams)") #Main title

```



Now plot both

```{r}
plot_grid(gg.hist.my.frogs,
          gg.hist.frog)
```

## Align vert

```{r}
plot_grid(gg.hist.my.frogs, 
          gg.hist.frog,
          nrow = 2)
```


## Density plot overlay

## Density plot

```{r}

ggdensity(data = frogarms,
            x = "mass",
            fill = "sex",
            xlab = "Mass (grams)",
          main = "Mass of Australian frogs ") #Main title

```

