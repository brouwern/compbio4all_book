---
title: "Chapter 4 code"
author: "brouwern@gmail.com"
date: "September 19, 2016"
output: html_document
---

```{r  include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


Code to generate Sampling distribution figures

```{r}
# load gene length data from Whitlock and Schulter 2nd ed
gene.length <- read.csv(file = "chap04e1HumanGeneLengths.csv")


#Remove 26 largest as per W&S 4.1, pg 97, 2nd ed
i.order <- order(gene.length$geneLength,decreasing = T)

gene.length2 <- gene.length$geneLength[i.order][-c(1:26)]


```



# Histogram of these gene lengths
```{r}
lwd. <- 8
par(mfrow = c(1,2), mar = c(5,4,4,1))
hist(gene.length2, xlab = "",ylab = "" ,#main = "", 
     #breaks = seq(0,15000,500),
     col = "firebrick",
     main = "Whole population")
mtext(text = "Frequency",side = 2, line = 2.2,cex = 1.1)
mtext(text = "Gene length",side = 1, line = 2.2,cex = 1.1)
abline(v = mean(gene.length2),lwd = lwd.)
legend("topright", legend = round(mean(gene.length2),2),bty = "n")

hist(my.genes, xlab = "",ylab = "" ,#main = "", 
     breaks = seq(0,15000,500),
     col = "firebrick",
     main = "Sample, n = 10")
mtext(text = "Frequency",side = 2, line = 2.2,cex = 1.1)
mtext(text = "Gene length",side = 1, line = 2.2,cex = 1.1)
abline(v = mean(my.genes),lwd = lwd.)
legend("topright", legend = mean(my.genes),bty = "n")
```




# Loop plot many histograms of samples of 10 genes
```{r}
par(mfrow = c(10,10),mar = c(0.1,0.4,0.1,0.1))
for(i in 1:100){
  my.genes10 <- sample(gene.length2, size = 10, replace = FALSE)
  
  hist(my.genes10, xlab = "",ylab = "",main = "",
       breaks = seq(0,15000,500),
       xaxt = "n", col = i,
       yaxt = "n")
  
}
```




# Build a sampling distribution 100000 samples

```{r}
means10000 <- vector()
for(i in 1:100000){
  my.genes100 <- sample(gene.length2, size = 100, 
                       replace = FALSE)
  
  means10000[i] <- mean(my.genes100)
  
}


```




#Plot sampling distribution

```{r}
lwd. <- 8
par(mfrow = c(1,1), mar = c(5,4,4,1))
hist(means10000, xlab = "",ylab = "" ,#main = "", 
     #breaks = seq(0,15000,500),
     col = "firebrick",
     main = "Sampling distribution")
mtext(text = "Frequency",side = 2, line = 2.2,cex = 1.1)
mtext(text = "Mean of 100 random genes",side = 1, line = 2.2,cex = 1.1)
abline(v = mean(means10000),lwd = lwd.)
legend("topright", legend = round(mean(gene.length2),2),bty = "n")
```




# Random sample of 20 genes

```{r}

means.n.of.20 <- vector()
for(i in 1:100000){
  my.genes100 <- sample(gene.length2, size = 20, 
                       replace = FALSE)
  
  means.n.of.20[i] <- mean(my.genes100)
}
  

```



# Random sample of 500 genes

```{r}


means.n.of.500 <- vector()
for(i in 1:100000){
  my.genes100 <- sample(gene.length2, size = 5000, 
                       replace = FALSE)
  
  means.n.of.500[i] <- mean(my.genes100)
  
}




```



# Plot 3 different sampling distributiosn

```{r}


par(mfrow = c(1,3), mar = c(5,4,4,1))

#N of 20
lwd. <- 8
brks <- seq(0,5500,100)
hist(means.n.of.20, xlab = "",ylab = "" ,main = "", 
breaks = brks,
     col = "firebrick")
mtext(text = "Frequency",side = 2, line = 2.2,cex = 1.1)
mtext(text = "n=20 rand. genes",side = 1, line = 2.2,cex = 1.1)
abline(v = mean(means10000),lwd = 3)

#N of 100
hist(means10000, xlab = "",ylab = "" , main = "", 
     breaks =brks,
     col = "firebrick")
mtext(text = "Frequency",side = 2, line = 2.2,cex = 1.1)
mtext(text = "n=100 rand. genes",side = 1, line = 2.2,cex = 1.1)

#N of 500
hist(means.n.of.500, xlab = "",ylab = "" ,main = "", 
     breaks = brks,
     col = "firebrick")
mtext(text = "Frequency",side = 2, line = 2.2,cex = 1.1)
mtext(text = "n=500 rand. genes",side = 1, line = 2.2,cex = 1.1)


```





# Made up example: size of bass at Pymatuning
```{r}
mu <- 5 
sig <- 1

N <- 10000

pop <- rnorm(n = N,mean = mu,sd = sig)


par(mfrow = c(1,1))
hist(pop,
     main = "All the LM bass of Pymatunin' ",
     xlab = "Mass (pounds)",
     xlim = c(0,10),
     col = 3,
     lwd = 2)
abline(v= mean(pop), lwd = 10)
legend("topleft",legend = paste("mu=",mu,"lbs"), bty = "n",cex = 2)



bass.y.bar <- vector()
for(i in 1:44){
  my.bass <- sample(pop,
                    size = 15, 
                    replace = FALSE)
  bass.y.bar[i] <- mean(my.bass)
}



par(mfrow = c(1,1))
hist(pop,
     main = "All the LM bass of Pymatunin' ",
     xlab = "Mass (pounds)",
     #xlim = c(4,6),
     col = 3,
     lwd = 2)

abline(v= bass.y.bar, lwd = 1)
abline(v= mean(pop), col = 2,lwd =3, lty = 2)

#legend("topleft",legend = paste("mu=",mu,"lbs"), bty = "n",cex = 2)



```




# a sample of bass
```{r}
my.bass <- sample(pop,
                    size = 15, 
                    replace = FALSE)

summary(my.bass)


mean. <- mean(my.bass)
se. <- sd(my.bass)/sqrt(length(my.bass))
errbar(x = 1,
       y = mean.,
       yplus = mean. + se.,
       yminus = mean. - se.,
       ylab = "Bass Mass (lbs)",
       xlab = "",
       cex = 5,
       xaxt = "n",
       xlim = c(0.75,1.25),
       col = 3,
       lwd = 4,
       pch = 16)
axis(side = 1,at = 1, "")
legend("toplef", legend = "n = 10 bass", bty = "n")
legend("bottomleft", legend = "Error bars = 1 SE",
        bty = "n")


```



# Boxplot vs. mean w/ se

```{r}

par(mfrow = c(1,2), mar = c(1,4,0,0))
boxplot(my.bass,ylab = "Bass Mass (lbs)")
errbar(x = 1,
       y = mean.,
       yplus = mean. + se.,
       yminus = mean. - se.,
       ylab = "",
       xlab = "",
       cex = 2,
       xaxt = "n",
       #yaxt = "n",
       xlim = c(0.75,1.25),
       col = 3,
       lwd = 2,
       pch = 16,
       ylim = c(min(my.bass), max(my.bass)) )
axis(side = 1,at = 1, "")
# legend("toplef", legend = "n = 10 bass", bty = "n")
# legend("bottomleft", legend = "Error bars = 1 SE",
#         bty = "n")


```





```{r}



summary(my.bass)


mean. <- mean(my.bass)
se. <- sd(my.bass)/sqrt
 
par(mfrow = c(1,2))
errbar(x = 1,
       y = mean.,
       yplus = mean. + se.,
       yminus = mean. - se.,
       ylab = "Bass Mass (lbs)",
       xlab = "",
       cex = 5,
       xaxt = "n",
       xlim = c(0.75,1.25),
       col = 3,
       lwd = 4,
       pch = 16,
       ylim = c(min(my.bass)+1, max(my.bass)-1)#,
      #main = "E"
       )
errbar(x = 1,
       y = mean.,
       yplus = mean. + se.*1.96,
       yminus = mean. - se.*1.96,
       ylab = "",
       xlab = "",
       cex = 5,
       xaxt = "n",
       xlim = c(0.75,1.25),
       col = 3,
       lwd = 4,
       pch = 16,
       ylim = c(min(my.bass)+1, max(my.bass)-1) 
       )
axis(side = 1,at = 1, "")
legend("toplef", legend = "n = 10 bass", bty = "n")
legend("bottomleft", legend = "Error bars = 95% CI",
        bty = "n")

```
























# Made up example: size of bass at Pymatuning
```{r}
mu <- 5 
sig <- 1

N <- 10000

pop <- rnorm(n = N,mean = mu,sd = sig)



bass.y.bar <- vector()
bass.se <- vector()
for(i in 1:100){
  my.bass <- sample(pop,
                    size = 15, 
                    replace = FALSE)
  bass.y.bar[i] <- mean(my.bass)
  bass.se[i] <- sd(my.bass)/sqrt(length(my.bass))
}






par(mfrow = c(1,1),
    mar = c(4,4,1,1))
library(Hmisc)
errbar(x = 1:length(bass.y.bar),
       y = bass.y.bar,
       yplus = bass.y.bar + bass.se*1.96,
       yminus = bass.y.bar - bass.se*1.96,
       #ylab = "",
       xlab = "Independent samples of 10 bass",
       cex = 1,
       xaxt = "n",
       col = 3,
       lwd = 1,
       pch = 16,
       ylab = "Mean mass (lbs)"
       )

abline(h = mean(pop))
axis(side = 1,at = 1:100, 1:100)

legend("bottomleft", legend = "horizontal line = true mean mu", bty = "n")


legend("bottomleft", legend = "Error bars = 95% CI",
        bty = "n")



```


