# Cicadas: real and simulated

* Morphological data on 13-year periodic cicadas
* One species (tredecim) has sample size so I simulate new observations from original data
* To make data more interesting for ANOVA I make one species(tredecula) sexually dimorophic

## Data details

* 3 species
    + tredecassini
    + tredecim
    + tredecula
* 2 genders
    + male
    + female
* 4 measurements
    + BW = body weight (g)
    + WL = wing length (mm)
    + WW = wing width 
    + BL = body length


https://en.wikipedia.org/wiki/Magicicada_tredecassini
http://magicicada.org/magicicada/m_tredecim/

## Cicada Data provenance

* Data download from http://www.math.uah.edu/stat/data/Cicada.html
* Originally collected by Ginger Rowell and Robert Grammer, Belmont College.
* Gender and Species recoded by hand in Excel




## Load Original Cicada data

* "skip = 7" skips the 7 head lines with background info I put at the top of the .csv file

```{r}
dat <- read.csv("cicada_data.csv", 
                skip = 7)
```



# Simulate fake tredecim observations

* only 6 observations for tredecim
* I make 24 more


```{r}
#model each trait
## mixed models would probably be better
mod.BW <- lm(BW ~ Species + G +       WL + WW + BL, data = dat)
mod.WL <- lm(WL ~ Species + G +  BW +      WW + BL, data = dat)
mod.WW <- lm(WW ~ Species + G +  BW + WL      + BL, data = dat)
mod.BL <- lm(BL ~ Species + G +  BW + WL + WW     , data = dat)


## focal species
i.tredecim <- which(dat$Species == "tredecim")

##simulate new trait data
BW.sim <- cbind(simulate(mod.BW,4),dat[,c("G","Species")])[i.tredecim,]
WL.sim <- cbind(simulate(mod.WL,4),dat[,c("G","Species")])[i.tredecim,]
WW.sim <- cbind(simulate(mod.WW,4),dat[,c("G","Species")])[i.tredecim,]
BL.sim <- cbind(simulate(mod.BL,4),dat[,c("G","Species")])[i.tredecim,]


#cleanup
names(BW.sim) <- gsub("sim","BW",names(BW.sim))
names(WL.sim) <- gsub("sim","WL",names(WL.sim))
names(WW.sim) <- gsub("sim","WW",names(WW.sim))
names(BL.sim) <- gsub("sim","BL",names(BL.sim))


```


Reshape simualted data 

```{r}
#melt siulated data
library(reshape2)
BW.melt <- melt(BW.sim)[,-3]
WL.melt <- melt(WL.sim)[,-3]
WW.melt <- melt(WW.sim)[,-3]
BL.melt <- melt(BL.sim)[,-3]


#name each column w/trait name
names(BW.melt)[3] <- "BW"
names(WL.melt)[3] <- "WL"
names(WW.melt)[3] <- "WW"
names(BL.melt)[3] <- "BL"

#add index
BW.melt$i <- 1:dim(BW.melt)[1]
WL.melt$i <- 1:dim(BW.melt)[1]
WW.melt$i <- 1:dim(BW.melt)[1]
BL.melt$i <- 1:dim(BW.melt)[1]

#merge
m1 <- merge(BW.melt,WL.melt)
m2 <- merge(WW.melt,BL.melt)

m3 <- merge(m1,m2)

```


# Add noise to original data

Original data only measured to nearest mm, which results in lots of overplotting.  Simulate decimal-place noise.

```{r}

dat$WL <- dat$WL + runif(length(dat$WL),-0.5,.5)
dat$WW <- dat$WW + runif(length(dat$WL),-0.5,.5)
dat$BL <- dat$BL + runif(length(dat$WL),-0.5,.5)

```


# Merge original and simualted data
```{r}

dat2 <- rbind(m3[, c("BW","WL","WW","BL","Species","G")]
     ,dat[, c("BW","WL","WW","BL","Species","G")])

```



# Add sexual dimorpism 
```{r}
i.dimorph <- which(dat2$Species == "tredecula" & 
                   dat2$G == "F")
dat3 <- dat2
dat3[i.dimorph,c("BW","WL","WW","BL")] <- dat2[i.dimorph,c("BW","WL","WW","BL")]+dat2[i.dimorph,c("BW","WL","WW","BL")]*0.10
```


# Change "G" to "Gender"
```{r}
names(dat)[5] <- "Gender"
names(dat2)[6] <- "Gender"
names(dat3)[6] <- "Gender"
```


# Save spreadshet

```{r}
write.csv(dat, "cicades_REAL.csv",row.names = F)
write.csv(dat2, "cicades_with_SIMS.csv",row.names = F)
write.csv(dat3, "cicades_with_FAKE_DATA.csv",row.names = F)
```




